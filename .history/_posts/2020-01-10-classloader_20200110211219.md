---
layout: post
tilel: 类加载的方式和双亲委派模型
---
问题23：类加载的过程，什么是双亲委派模型

Java 引入了字节码 和 JVM ，提供了 Java 语言跨平台的能力，理解类加载的过程是深入 Java 开发的前提。

### 典型回答

一般地将 Java 初始化分为三个步骤：加载，链接， 初始化。

* 加载，将 Java 字节码读取到 JVM 中，并映射为 JVM 认可的数据结构。如果 JVM 不认可数据结构，则会抛出ClassFormatError；
* 链接，将 加载好的数据结构，平滑装入转入 JVM 运行的的过程，可以分为以下三个阶段：
  * 验证，这是虚拟机安全的重要保障，JVM 需要校验字节信息是符合 Java 虚拟机规范的， 否则抛出 VerifyError，验证可以防止恶意的信息或者不规范信息危害 JVM 的行为；
  * 准备，创建类或者接口中的静态变量，并初始化静态变量的值，但是这里的“初始化”侧重于分配内存空间，与开发中的初始化不同；
  * 解析，这一步会将常量池中的符号引用转换为直接引用，
* 初始化，真正执行初始化的代码逻辑，包括静态字段的赋值，以及执行类定义内部静态初始化块内的逻辑。


Java 的双亲委派模型是指，当前类加载器在试图加载某个类型的时候，除非父加载器找不到相应的类型，否则尽量将这个任务代理给当前任务加载器的父加载器去做。避免了 Java 类型的重复加载。

### 考点分析

上面的回答是 Java 类加载的主要内容。

类加载也可以从开发和部署来考虑：
* 如果要真正理解双亲委派模型，需要理解 Java 中类加载器的架构和职责，至少要懂具体有哪些内建的类加载器，这些是我上面的回答里没有提到的；以及如何自定义类加载器？
* 从应用角度，解决某些类加载问题，例如我的 Java 程序启动较慢，有没有办法尽量减小 Java 类加载的开销？另外，需要注意的是，在 